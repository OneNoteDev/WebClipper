/// <reference path="../../node_modules/onenoteapi/target/oneNoteApi.d.ts" />

// Initialization for all tests
import {Polyfills} from "../scripts/polyfills";
import {Clipper} from "../scripts/clipperUI/frontEndGlobals";
import {Communicator} from "../scripts/communicator/communicator";
import {StubSessionLogger} from "../scripts/logging/stubSessionLogger";
import {MockMessageHandler} from "./communicator/mockMessageHandler";

Polyfills.init();

Clipper.setInjectCommunicator(new Communicator(new MockMessageHandler(), "INJECT_MOCK_COMM"));
Clipper.setExtensionCommunicator(new Communicator(new MockMessageHandler(), "EXTENSION_MOCK_COMM"));
Clipper.logger = new StubSessionLogger();

import "./clipperUI/components/previewViewer/augmentationPreview_tests";
import "./clipperUI/components/previewViewer/fullPagePreview_tests";
import "./clipperUI/components/previewViewer/pdfPageViewport_tests";
import "./clipperUI/components/previewViewer/pdfPreview_tests";
import "./clipperUI/components/previewViewer/pdfPreviewPage_tests";
import "./clipperUI/components/previewViewer/previewViewerAugmentationHeader_tests";
import "./clipperUI/components/previewViewer/previewViewerPdfHeader_tests";
import "./clipperUI/components/previewViewer/previewViewerRegionHeader_tests";
import "./clipperUI/components/previewViewer/regionPreview_tests";
import "./clipperUI/components/previewViewer/selectionPreview_tests";

import "./clipperUI/components/annotationInput_tests";
import "./clipperUI/components/footer_tests";
import "./clipperUI/components/modeButton_tests";
import "./clipperUI/components/modeButtonSelector_tests";
import "./clipperUI/components/sectionPicker_tests";

import "./clipperUI/panels/changeLogPanel_tests";
import "./clipperUI/panels/clippingPanel_tests";
import "./clipperUI/panels/clippingPanelWithDelayedMessage_tests";
import "./clipperUI/panels/dialogPanel_tests";
import "./clipperUI/panels/optionsPanel_tests";
import "./clipperUI/panels/ratingsPanel_tests";
import "./clipperUI/panels/signInPanel_tests";

import "./clipperUI/mainController_tests";
import "./clipperUI/oneNoteApiUtils_tests";
import "./clipperUI/ratingsHelper_tests";
import "./clipperUI/regionSelector_tests";

import "./communicator/communicator_tests";
import "./communicator/iframeMessageHandler_tests";
import "./communicator/smartValue_tests";

import "./contentCapture/augmentationHelper_tests";
import "./contentCapture/bookmarkHelper_tests";

import "./domParsers/domUtils_tests";
import "./domParsers/videoUtils_tests";
import "./domParsers/khanAcademyVideo_tests";
import "./domParsers/vimeoVideo_tests";
import "./domParsers/youtubeVideo_tests";

import "./extensions/authenticationHelper_tests";
import "./extensions/extensionBase_tests";
import "./extensions/injectHelper_tests";
import "./extensions/tooltipHelper_tests";

import "./highlighting/highlighter_tests";

import "./http/cachedHttp_tests";
import "./http/clipperCachedHttp_tests";
import "./http/http_tests";

import "./localization/localization_tests";
import "./localization/rtl_tests";

import "./logging/communicatorLoggerPure_tests";
import "./logging/consoleLoggerShell_tests";
import "./logging/context_tests";
import "./logging/logger_tests";
import "./logging/loggerDecorator_tests";
import "./logging/logHelpers_tests";
import "./logging/sessionLogger_tests";

import "./saveToOneNote/oneNoteSaveablePage_tests";
import "./saveToOneNote/oneNoteSaveablePdf_tests";
import "./saveToOneNote/saveToOneNote_tests";

import "./storage/clipperData_tests";
import "./storage/clipperStorageGateStrategy_tests";

import "./versioning/version_tests";
import "./versioning/changeLogHelper_tests";

import "./arrayUtils_tests";
import "./clipperUrls_tests";
import "./experiments_tests";
import "./objectUtils_tests";
import "./promiseUtils_tests";
import "./settings_tests";
import "./stringUtils_tests";
import "./urlUtils_tests";
